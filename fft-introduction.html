
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformation de Fourier, FFT et DFT &#8212; Cours Python</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/my-styles.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/translations.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Approximation de la transformée de Fourier spatiale grâce à la FFT" href="fft-spatiale.html" />
    <link rel="prev" title="Transformation de Fourier" href="fft-fourier.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

<!-- Ajout DC pour Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-35563429-1', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="https://www.courspython.com/">
          CoursPython</a>
<!--        <span class="navbar-text navbar-version pull-left"><b>2</b></span>
 -->
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="sommaire.html">Sommaire</a></li>
                <li><a href="genindex.html">Index</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="sommaire.html">Plan <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bases-python.html">Bases de Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction-python.html">Introduction à Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="tests.html">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="boucles.html">Boucles</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">Principaux types de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="tuple.html">Tuples en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="dictionnaire.html">Dictionnaires en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions.html">Fonctions en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">Modules et importations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apprendre-numpy.html">Introduction à NumPy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apprendre-numpy.html#variables-predefinies">Variables prédéfinies</a></li>
<li class="toctree-l2"><a class="reference internal" href="apprendre-numpy.html#tableaux-numpy-array">Tableaux - <code class="xref std std-keyword docutils literal notranslate"><span class="pre">numpy.array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="apprendre-numpy.html#la-fonction-numpy-arange">La fonction <code class="xref std std-keyword docutils literal notranslate"><span class="pre">numpy.arange()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="apprendre-numpy.html#la-fonction-numpy-linspace">La fonction <code class="xref std std-keyword docutils literal notranslate"><span class="pre">numpy.linspace()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="apprendre-numpy.html#action-d-une-fonction-mathematique-sur-un-tableau">Action d’une fonction mathématique sur un tableau</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fonctions-mathematiques-numpy.html">Fonctions mathématiques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fonctions-mathematiques-numpy.html#fonctions-trigonometriques">Fonctions trigonométriques</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions-mathematiques-numpy.html#fonctions-hyperboliques">Fonctions hyperboliques</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions-mathematiques-numpy.html#fonctions-diverses">Fonctions diverses</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions-mathematiques-numpy.html#fonctions-utiles-pour-les-nombres-complexes">Fonctions utiles pour les nombres complexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions-mathematiques-numpy.html#arrondis">Arrondis</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions-mathematiques-numpy.html#nombres-aleatoires">Nombres aléatoires</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction-courbes.html">Tracé de courbes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction-courbes.html#creation-d-une-courbe">Création d’une courbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction-courbes.html#affichage-de-plusieurs-courbes">Affichage de plusieurs courbes</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction-courbes.html#formats-de-courbes">Formats de courbes</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction-courbes.html#trace-de-formes">Tracé de formes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tableaux-numpy.html">Tableaux et calcul matriciel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tableaux-numpy.html#tableaux-numpy-array">Tableaux - <code class="xref std std-keyword docutils literal notranslate"><span class="pre">numpy.array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tableaux-numpy.html#tableaux-et-slicing">Tableaux et slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tableaux-numpy.html#algebre-lineaire">Algèbre linéaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="tableaux-numpy.html#changement-de-la-taille-d-un-tableau">Changement de la taille d’un tableau</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation et animation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tracer-plusieurs-courbes.html">Affichage de plusieurs tracés dans la même figure</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation-couleur.html">Visualisation d’une fonction de 2 variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracer-fonction-valeurs-complexes.html">Visualisation d’une fonction à valeurs complexes avec Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="animation-matplotlib.html">Animation avec matplotlib</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="fft-fourier.html">Transformation de Fourier</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Transformation de Fourier, FFT et DFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="#approximation-de-la-transformee-de-fourier-grace-a-la-fft">Approximation de la transformée de Fourier grâce à la FFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="fft-spatiale.html">Approximation de la transformée de Fourier spatiale grâce à la FFT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classes-et-objets.html">Classes et objets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="classes-et-objets.html#breve-introduction-a-la-programmation-orientee-objet">Brève introduction à la Programmation Orientée Objet</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes-et-objets.html#les-notions-de-classe-et-d-objet">Les notions de classe et d’objet</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes-et-objets.html#la-notion-d-encapsulation">La notion d’encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes-et-objets.html#attributs-et-methodes-de-classe">Attributs et méthodes de classe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interface-graphique.html">Introduction à Qt5 et PyQt5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interfaces.html">Introduction aux interfaces graphiques en Python avec Qt 5 et PyQt5</a></li>
<li class="toctree-l2"><a class="reference internal" href="boutons.html">Premier bouton en Python avec Qt 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="composants.html">Composants graphiques usuels avec Qt 5</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pylab.html">Utilisation de PyLab</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction-pylab.html">Introduction à PyLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="fonctions_mathematiques.html">Fonctions mathématiques avec PyLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="tableaux.html">Tableaux et calcul matriciel avec PyLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="animations.html">Animation avec PyLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="courbes_complexes.html">Visualisation d’une fonction à valeurs complexes avec PyLab</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fiches-pratiques.html">Fiches pratiques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="derivee-fonction.html">Dérivée d’une fonction en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="integration-numerique.html">Intégration numérique</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annexes.html">Annexes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interface-graphique-pyqt4.html">Interfaces graphiques avec Qt4 et PyQt4</a></li>
<li class="toctree-l2"><a class="reference internal" href="TP-pi-Monte-Carlo.html">Calcul de <span class="math notranslate nohighlight">\(\pi\)</span> avec la méthode Monte-Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="TP-quantique.html">TP Quantique - Valeurs propres et vecteurs propres</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bibliographie.html">Bibliographie</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bibliographie.html#manuels-d-initiation-a-la-programmation">Manuels d’initiation à la programmation</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="fft-fourier.html" title="Previous Chapter: Transformation de Fourier"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Transformatio...</span>
    </a>
  </li>
  <li>
    <a href="fft-spatiale.html" title="Next Chapter: Approximation de la transformée de Fourier spatiale grâce à la FFT"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Approximation... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            <form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Rechercher" />
 </div>
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
  <div class="col-md-3">
	<div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bases-python.html">Bases de Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="apprendre-numpy.html">Introduction à NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="fonctions-mathematiques-numpy.html">Fonctions mathématiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-courbes.html">Tracé de courbes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tableaux-numpy.html">Tableaux et calcul matriciel</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation et animation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="fft-fourier.html">Transformation de Fourier</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Transformation de Fourier, FFT et DFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction-a-la-fft-et-a-la-dft">Introduction à la FFT et à la DFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemples-simples">Exemples simples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#visualisation-de-la-partie-reelle-et-imaginaire-de-la-transformee">Visualisation de la partie réelle et imaginaire de la transformée</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visualisation-des-valeurs-complexes-avec-une-echelle-coloree">Visualisation des valeurs complexes avec une échelle colorée</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exemple-avec-a-2-1">Exemple avec a[2]=1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exemple-avec-a-0-1">Exemple avec a[0]=1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exemple-avec-cosinus">Exemple avec cosinus</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exemple-avec-sinus">Exemple avec sinus</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fonction-fftfreq">Fonction fftfreq</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonction-fftshift">Fonction fftshift</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#approximation-de-la-transformee-de-fourier-grace-a-la-fft">Approximation de la transformée de Fourier grâce à la FFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exemple-dans-le-cas-d-une-gaussienne">Exemple dans le cas d’une gaussienne</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemple-avec-visualisation-en-couleur-de-la-transformee-de-fourier">Exemple avec visualisation en couleur de la transformée de Fourier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemple-avec-translation">Exemple avec translation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fft-spatiale.html">Approximation de la transformée de Fourier spatiale grâce à la FFT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classes-et-objets.html">Classes et objets</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface-graphique.html">Introduction à Qt5 et PyQt5</a></li>
<li class="toctree-l1"><a class="reference internal" href="pylab.html">Utilisation de PyLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="fiches-pratiques.html">Fiches pratiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="annexes.html">Annexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliographie.html">Bibliographie</a></li>
</ul>

	</div>
  </div>
    <div class="col-md-9">
      
  <div class="section" id="transformation-de-fourier-fft-et-dft">
<h1>Transformation de Fourier, FFT et DFT<a class="headerlink" href="#transformation-de-fourier-fft-et-dft" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="introduction-a-la-fft-et-a-la-dft">
<h2>Introduction à la FFT et à la DFT<a class="headerlink" href="#introduction-a-la-fft-et-a-la-dft" title="Lien permanent vers ce titre">¶</a></h2>
<p>La Transformée de Fourier Rapide, appelée <strong>FFT</strong> <em>Fast Fourier Transform en anglais</em>, est un algorithme qui permet de calculer des Transformées de Fourier Discrètes <strong>DFT</strong> <em>Discrete Fourier Transform en anglais</em>.</p>
<p>Parce que la DFT permet de déterminer la pondération entre différentes fréquences discrètes, elle a un grand nombre d’applications en traitement du signal, par exemple pour du filtrage. Par conséquent, les données discrètes qu’elle prend en entrée sont souvent appelées <em>signal</em> et dans ce cas on considère qu’elles sont définies dans le domaine temporel. Les valeurs de sortie sont alors appelées le <em>spectre</em> et sont définies dans le domaine des fréquences. Toutefois, ce n’est pas toujours le cas et cela dépend des données à traiter.</p>
<p>Il existe plusieurs façons de définir la DFT, en particulier au niveau du signe que l’on met dans l’exponentielle et dans la façon de normaliser. Dans le cas de NumPy, l’implémentation de la DFT est la suivante :</p>
<p><span class="math notranslate nohighlight">\(A_k=\sum\limits_{m=0}^{n-1}{a_m\exp\left\{ -2\pi i\frac{mk}{n} \right\}}\text{ avec }k=0,\ldots ,n-1\)</span></p>
<p>La DFT inverse est donnée par :</p>
<p><span class="math notranslate nohighlight">\(a_m=\frac{1}{n}\sum\limits_{k=0}^{n-1}{A_k\exp\left\{ 2\pi i\frac{mk}{n} \right\}}\text{ avec }m=0,\ldots ,n-1\)</span></p>
<p>Elle diffère de la transformée directe par le signe de l’argument de l’exponentielle et par la normalisation à 1/n par défaut.</p>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.fft.html">https://docs.scipy.org/doc/numpy/reference/routines.fft.html</a></p>
</div>
</div>
<div class="section" id="exemples-simples">
<h2>Exemples simples<a class="headerlink" href="#exemples-simples" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="visualisation-de-la-partie-reelle-et-imaginaire-de-la-transformee">
<h3>Visualisation de la partie réelle et imaginaire de la transformée<a class="headerlink" href="#visualisation-de-la-partie-reelle-et-imaginaire-de-la-transformee" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># definition de a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># visualisation de a</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>

<span class="c1"># calcul de A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># visualisation de A</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;partie reelle&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;partie imaginaire&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/test_fft1.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft1.png" src="_images/test_fft1.png" />
</div>
</div>
<div class="section" id="visualisation-des-valeurs-complexes-avec-une-echelle-coloree">
<h3>Visualisation des valeurs complexes avec une échelle colorée<a class="headerlink" href="#visualisation-des-valeurs-complexes-avec-une-echelle-coloree" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour plus d’informations sur cette technique de visualisation, voir <a class="reference internal" href="courbes_complexes.html"><span class="doc">Visualisation d’une fonction à valeurs complexes avec PyLab</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># definition de a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># visualisation de a</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>

<span class="c1"># calcul de k</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># calcul de A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># visualisation de A - Attention au changement de variable</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># calcul d&#39;une valeur supplementaire</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hsv</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/test_fft2.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft2.png" src="_images/test_fft2.png" />
</div>
</div>
<div class="section" id="exemple-avec-a-2-1">
<h3>Exemple avec a[2]=1<a class="headerlink" href="#exemple-avec-a-2-1" title="Lien permanent vers ce titre">¶</a></h3>
<p>(<a class="reference external" href="./fft/test_fft3.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft3.png" src="_images/test_fft3.png" />
</div>
</div>
<div class="section" id="exemple-avec-a-0-1">
<h3>Exemple avec a[0]=1<a class="headerlink" href="#exemple-avec-a-0-1" title="Lien permanent vers ce titre">¶</a></h3>
<p>(<a class="reference external" href="./fft/test_fft4.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft4.png" src="_images/test_fft4.png" />
</div>
</div>
<div class="section" id="exemple-avec-cosinus">
<h3>Exemple avec cosinus<a class="headerlink" href="#exemple-avec-cosinus" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># definition de a</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># visualisation de a</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>

<span class="c1"># calcul de A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># visualisation de A</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;partie reelle&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;partie imaginaire&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/test_fft5.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft5.png" src="_images/test_fft5.png" />
</div>
</div>
<div class="section" id="exemple-avec-sinus">
<h3>Exemple avec sinus<a class="headerlink" href="#exemple-avec-sinus" title="Lien permanent vers ce titre">¶</a></h3>
<p>(<a class="reference external" href="./fft/test_fft6.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft6.png" src="_images/test_fft6.png" />
</div>
<p><strong>Exemple avec cosinus sans prise en compte de la période dans l’affichage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># definition de a</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># visualisation de a</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># calcul de A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># visualisation de A</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;partie reelle&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/test_fft7a.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft7a.png" src="_images/test_fft7a.png" />
</div>
</div>
</div>
<div class="section" id="fonction-fftfreq">
<h2>Fonction fftfreq<a class="headerlink" href="#fonction-fftfreq" title="Lien permanent vers ce titre">¶</a></h2>
<p>numpy.fft.fftfreq renvoie les fréquences du signal calculé dans la DFT.</p>
<p>Le tableau freq renvoyé contient les fréquences discrètes en nombre de cycles par pas de temps. Par exemple si le pas de temps est en secondes, alors les fréquences seront données en cycles/seconde.</p>
<p>Si le signal contient n pas de temps et que le pas de temps vaut d :</p>
<p>freq = [0, 1, …,   n/2-1,     -n/2, …, -1] / (d*n)   si n est pair</p>
<p>freq = [0, 1, …, (n-1)/2, -(n-1)/2, …, -1] / (d*n)   si n est impair</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># definition du signal</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">T2</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T1</span><span class="o">*</span><span class="n">T2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">T1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">T2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># affichage du signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">signal</span><span class="p">)</span>

<span class="c1"># calcul de la transformee de Fourier et des frequences</span>
<span class="n">fourier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">size</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="c1"># affichage de la transformee de Fourier</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">fourier</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">fourier</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;imag&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/test_fft_avec_freq.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/test_fft_avec_freq.png" src="_images/test_fft_avec_freq.png" />
</div>
</div>
<div class="section" id="fonction-fftshift">
<h2>Fonction fftshift<a class="headerlink" href="#fonction-fftshift" title="Lien permanent vers ce titre">¶</a></h2>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span>
<span class="go">array([ 0.  ,  1.25,  2.5 ,  3.75, -5.  , -3.75, -2.5 , -1.25])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">array([-5.  , -3.75, -2.5 , -1.25,  0.  ,  1.25,  2.5 ,  3.75])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_f</span>
<span class="go">array([ 0.  ,  1.25,  2.5 ,  3.75, -5.  , -3.75, -2.5 , -1.25])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="approximation-de-la-transformee-de-fourier-grace-a-la-fft">
<h1>Approximation de la transformée de Fourier grâce à la FFT<a class="headerlink" href="#approximation-de-la-transformee-de-fourier-grace-a-la-fft" title="Lien permanent vers ce titre">¶</a></h1>
<p>Lorsqu’on désire calculer la transformée de Fourier d’une fonction <span class="math notranslate nohighlight">\(x(t)\)</span> à l’aide d’un ordinateur, ce dernier ne travaille que sur des valeurs discrètes, on est amené à :</p>
<ul class="simple">
<li><p>discrétiser la fonction temporelle,</p></li>
<li><p>tronquer la fonction temporelle,</p></li>
<li><p>discrétiser la fonction fréquentielle.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(X(f) = \int\limits_{-\infty}^{+\infty} x(t) e^{-2\pi i f t}dt\)</span></p>
<p>En approchant l’intégrale par une somme d’aires de rectangles de durée <span class="math notranslate nohighlight">\(\Delta t\)</span> et en limitant la durée d’intégration
à un intervalle de longueur <span class="math notranslate nohighlight">\(n \Delta t\)</span>, c’est-à-dire en faisant une somme pour <span class="math notranslate nohighlight">\(n\)</span> valeurs <span class="math notranslate nohighlight">\(t_m = m \Delta t\)</span> avec <span class="math notranslate nohighlight">\(m\)</span> allant de <span class="math notranslate nohighlight">\(0\)</span> à <span class="math notranslate nohighlight">\(n-1\)</span>, on obtient :</p>
<p><span class="math notranslate nohighlight">\(X(f) \approx \Delta t \sum\limits_{m=0}^{n-1}{ x(t_m) e^{-2\pi i f \, t_m}}\)</span></p>
<p>Or, si on choisit des fréquences discrètes telles que <span class="math notranslate nohighlight">\(f_k = k \frac{1}{n \Delta t}\)</span>, on a <span class="math notranslate nohighlight">\(f_k t_m = k \frac{1}{n \Delta t} m \Delta t = \frac{mk}{n}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(X(f_k) \approx \Delta t \sum\limits_{m=0}^{n-1}{ x(t_m) e^{-2\pi i  f_k t_m} }
\approx \Delta t \sum\limits_{m=0}^{n-1}{ x(t_m) e^{-2\pi i \frac{m k}{n}}}\approx \Delta t \,\text{fft}(x)\)</span></p>
<div class="section" id="exemple-dans-le-cas-d-une-gaussienne">
<h2>Exemple dans le cas d’une gaussienne<a class="headerlink" href="#exemple-dans-le-cas-d-une-gaussienne" title="Lien permanent vers ce titre">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">nc</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">nc</span> <span class="o">*</span> <span class="n">dt</span>

<span class="c1"># definition d&#39;un signal gaussien</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nc</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># on effectue un ifftshift pour positionner le temps zero comme premier element</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="c1"># on effectue un fftshift pour positionner la frequence zero au centre</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># calcul des frequences avec fftfreq</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

<span class="c1"># comparaison avec la solution exacte</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/preparation_fft_new_2015a.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/preparation_fft_new_2015a.png" src="_images/preparation_fft_new_2015a.png" />
</div>
<p>Pour vérifier notre calcul, nous avons utilisé une transformée de Fourier connue. En effet, pour la définition utilisée, la transformée de Fourier d’une gaussienne <span class="math notranslate nohighlight">\(e^{-\alpha t^2}\)</span> est donnée par :</p>
<p><span class="math notranslate nohighlight">\(\sqrt{\frac{\pi}{\alpha}}e^{-\frac{(\pi f)^2}{\alpha}}\)</span></p>
</div>
<div class="section" id="exemple-avec-visualisation-en-couleur-de-la-transformee-de-fourier">
<h2>Exemple avec visualisation en couleur de la transformée de Fourier<a class="headerlink" href="#exemple-avec-visualisation-en-couleur-de-la-transformee-de-fourier" title="Lien permanent vers ce titre">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">nc</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">nc</span> <span class="o">*</span> <span class="n">dt</span>

<span class="c1"># definition d&#39;un signal gaussien</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nc</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># on effectue un ifftshift pour positionner le temps zero comme premier element</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="c1"># on effectue un fftshift pour positionner la frequence zero au centre</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># calcul des frequences avec fftfreq</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

<span class="c1"># visualisation de X - Attention au changement de variable</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># calcul d&#39;une valeur supplementaire</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hsv</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/preparation_fft_new_2015b.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/preparation_fft_new_2015b.png" src="_images/preparation_fft_new_2015b.png" />
</div>
</div>
<div class="section" id="exemple-avec-translation">
<h2>Exemple avec translation<a class="headerlink" href="#exemple-avec-translation" title="Lien permanent vers ce titre">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">nc</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">nc</span> <span class="o">*</span> <span class="n">dt</span>

<span class="c1"># definition d&#39;un signal gaussien</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nc</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># on effectue un ifftshift pour positionner le temps zero comme premier element</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="c1"># on effectue un fftshift pour positionner la frequence zero au centre</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># calcul des frequences avec fftfreq</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

<span class="c1"># visualisation de X - Attention au changement de variable</span>
<span class="c1"># on ajoute a droite la valeur de gauche pour la periodicite</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># calcul d&#39;une valeur supplementaire</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hsv</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./fft/preparation_fft_new_2015c.py">Source code</a>)</p>
<div class="figure align-default">
<img alt="_images/preparation_fft_new_2015c.png" src="_images/preparation_fft_new_2015c.png" />
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.fft.html">https://docs.scipy.org/doc/numpy/reference/routines.fft.html</a></p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Retour haut de page</a>
      
    </p>

   <p>

<a href="https://twitter.com/share" class="twitter-share-button" data-via="CoursPython" data-lang="fr">Tweeter</a>
<a href="https://twitter.com/CoursPython" class="twitter-follow-button" data-show-count="false" data-lang="fr">Suivre @CoursPython</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    </p>
    <p>
          <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/fr/80x15.png" align="absmiddle"/></a> 2020, David Cassagne.
Création le 15 Oct 2012.
        Mis à jour le 06 sept. 2020.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.1.2.
    </p>
  </div>
</footer>
  </body>
</html>